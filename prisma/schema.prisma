generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id              Int              @id @default(autoincrement())
  email           String           @unique
  name            String?
  password        String?
  tempPassword    String?          @map("temp_password")
  role            String
  merchantId      Int?             @map("merchant_id")
  merchant        User?            @relation("MerchantUsers", fields: [merchantId], references: [id])
  members         User[]           @relation("MerchantUsers")
  projects        Project[]
  isFirstLogin    Boolean          @default(true) @map("is_first_login")
  status          Boolean          @default(true)
  createdAt       DateTime         @default(now()) @map("created_at")
  updatedAt       DateTime         @updatedAt @map("updated_at")
  taskAssignments TaskAssignment[]
}

model Project {
  id              Int              @id @default(autoincrement())
  uuid            String?
  merchantId      Int              @map("merchant_id")
  merchant        User             @relation(fields: [merchantId], references: [id])
  name            String
  description     String?
  status          Boolean          @default(true)
  tasks           Task[]
  taskAssignments TaskAssignment[]
  createdAt       DateTime         @default(now()) @map("created_at")
  updatedAt       DateTime         @updatedAt @map("updated_at")
}

model Task {
  id              Int              @id @default(autoincrement())
  uuid            String?
  projectId       Int              @map("project_id")
  project         Project          @relation(fields: [projectId], references: [id])
  name            String
  description     String?
  status          Boolean          @default(true)
  createdAt       DateTime         @default(now()) @map("created_at")
  updatedAt       DateTime         @updatedAt @map("updated_at")
  assignments     TaskAssignment[]
  taskAssignments TaskAssignment[]
}

model TaskAssignment {
  id        Int      @id @default(autoincrement())
  taskId    Int      @map("task_id")
  userId    Int      @map("user_id")
  task      Task     @relation(fields: [taskId], references: [id])
  user      User     @relation(fields: [userId], references: [id])
  createdAt DateTime @default(now()) @map("created_at")
  updatedAt DateTime @updatedAt @map("updated_at")
}
